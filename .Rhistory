# Strike ####
# Refined Model
fb_l_strike <- glm(STRIKE ~ pitch_speed + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = fb_l, family = binomial)
# Removed: pfx_x, pfx_z
# Model Evaluation
# summary(fb_l_strike)
fb_l_strike_test <- augment(fb_l_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "left",
pitch = "fastball")
rmse(fb_l_strike_test$prediction, fb_l_strike_test$STRIKE)
sl_r <- rhp %>%
filter(pitch_type == "SL",
hitter == "R") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
sl_r_whiff <- glm(whiff ~ pfx_x + pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = sl_r, family = binomial)
# Removed: pitch_speed
# Model Evaluation
# summary(sl_r_whiff)
sl_r_whiff_test <- augment(sl_r_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "right",
pitch = "slider")
rmse(sl_r_whiff_test$prediction, sl_r_whiff_test$whiff)
# Barrel ####
# Refined Model
sl_r_barrel <- glm(Barrel ~ dist_x + dist_z +
I(dist_x^2) + I(dist_z^2) + pred_bbarrel,
data = sl_r, family = binomial)
# Removed: release_spin_rate, pfx_total, dist_prop, zone, pfx_x, pfx_z, pitch_speed
# Model Evaluation
# summary(sl_r_barrel)
sl_r_barrel_test <- augment(sl_r_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "right",
pitch = "slider")
rmse(sl_r_barrel_test$prediction, sl_r_barrel_test$Barrel)
# Strike ####
# Refined Model
sl_r_strike <- glm(STRIKE ~ pitch_speed + pfx_x + pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = sl_r, family = binomial)
# Removed: None
# Model Evaluation
# summary(sl_r_strike)
sl_r_strike_test <- augment(sl_r_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "right",
pitch = "slider")
rmse(sl_r_strike_test$prediction, sl_r_strike_test$STRIKE)
sl_l <- rhp %>%
filter(pitch_type == "SL",
hitter == "L") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
sl_l_whiff <- glm(whiff ~ pitch_speed + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = sl_l, family = binomial)
# Removed: pfx_z, pfx_x, pfx_total
# Model Evaluation
# summary(sl_l_whiff)
sl_l_whiff_test <- augment(sl_l_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "left",
pitch = "slider")
rmse(sl_l_whiff_test$prediction, sl_l_whiff_test$whiff)
# Barrel ####
# Refined Model
sl_l_barrel <- glm(Barrel ~ pitch_speed + pfx_x + pfx_z + zone + dist_x + dist_z +
I(dist_x^2) + I(dist_z^2) + pred_bbarrel,
data = sl_l, family = binomial)
# Removed: pfx_total, dist_prop, release_spin_rate
# Model Evaluation
# summary(sl_l_barrel)
sl_l_barrel_test <- augment(sl_l_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "left",
pitch = "slider")
rmse(sl_l_barrel_test$prediction, sl_l_barrel_test$Barrel)
# Strike ####
# Refined Model
sl_l_strike <- glm(STRIKE ~ pfx_x + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + pred_bstrike,
data = sl_l, family = binomial)
# Removed: pfx_z, release_spin_rate, pitch_speed
# Model Evaluation
# summary(sl_l_strike)
sl_l_strike_test <- augment(sl_l_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "left",
pitch = "slider")
rmse(sl_l_strike_test$prediction, sl_l_strike_test$STRIKE)
models <- rbind(
tidy(fb_r_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "fastball"),
tidy(fb_r_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "fastball"),
tidy(fb_r_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "fastball"),
tidy(sl_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "slider"),
tidy(sl_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "slider"),
tidy(sl_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "slider"),
tidy(sl_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "slider"),
tidy(sl_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "slider"),
tidy(sl_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "slider"))
# write.csv(models, "models2.csv")
batter_preds_r <- batter_stats %>%
left_join(batter_stats2, by = c("batter", "pitch_type")) %>%
left_join(batter_stats3, by = c("batter", "pitch_type")) %>%
select(batter, pitch_type, pitches, pred_bwhiff, pred_bbarrel, pred_bstrike) %>%
mutate(hitter = "R")
batter_preds_l <- batter_stats_l %>%
left_join(batter_stats2_l, by = c("batter", "pitch_type")) %>%
left_join(batter_stats3_l, by = c("batter", "pitch_type")) %>%
select(batter, pitch_type, pitches, pred_bwhiff, pred_bbarrel, pred_bstrike) %>%
mutate(hitter = "L")
pred_means <- rbind(batter_preds_r, batter_preds_l) %>%
group_by(hitter, pitch_type) %>%
summarize(whiff_mean = weighted.mean(pred_bwhiff, pitches, na.rm = TRUE),
barrel_mean = weighted.mean(pred_bbarrel, pitches, na.rm = TRUE),
strike_mean = weighted.mean(pred_bstrike, pitches, na.rm = TRUE))
# write.csv(pred_means, "pred means.csv")
cu_r <- rhp %>%
filter(pitch_type == "CU",
hitter == "R") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
cu_r_whiff <- glm(whiff ~ pfx_z + pfx_total + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = cu_r, family = binomial)
cu_r_whiff_formula <- step(cu_r_whiff, direction = "backward")
cu_r_whiff_formula$formula
# Removed: pitch_speed, pfx_x
cu_r_whiff_test <- augment(cu_r_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "right",
pitch = "curveball")
rmse(cu_r_whiff_test$prediction, cu_r_whiff_test$whiff)
# Barrel ####
# Refined Model
cu_r_barrel <- glm(Barrel ~ pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bbarrel,
data = cu_r, family = binomial)
cu_r_barrel_formula <- step(cu_r_barrel, direction = "backward")
cu_r <- rhp %>%
filter(pitch_type == "CU",
hitter == "R") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
cu_r_whiff <- glm(whiff ~ pfx_z + pfx_total + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = cu_r, family = binomial)
cu_r_whiff_formula <- step(cu_r_whiff, direction = "backward")
cu_r_whiff_formula$formula
# Removed: pitch_speed, pfx_x
cu_r_whiff_test <- augment(cu_r_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "right",
pitch = "curveball")
rmse(cu_r_whiff_test$prediction, cu_r_whiff_test$whiff)
# Barrel ####
# Refined Model
cu_r_barrel <- glm(Barrel ~ pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bbarrel,
data = cu_r, family = binomial)
# Removed: pitch_speed, pfx_x
cu_r_barrel_test <- augment(cu_r_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "right",
pitch = "curveball")
rmse(cu_r_barrel_test$prediction, cu_r_barrel_test$Barrel)
# Strike ####
# Refined Model
cu_r_strike <- glm(STRIKE ~ pfx_z + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = cu_r, family = binomial)
cu_r_strike_formula <- step(cu_r_strike, direction = "backward")
cu_r_strike_formula$formula
# Removed: pitch_speed, pfx_x, pfx_total
cu_r_strike_test <- augment(cu_r_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "right",
pitch = "curveball")
rmse(cu_r_strike_test$prediction, cu_r_strike_test$STRIKE)
cu_r <- rhp %>%
filter(pitch_type == "CU",
hitter == "R") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
cu_r_whiff <- glm(whiff ~ pfx_z + pfx_total + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = cu_r, family = binomial)
cu_r_whiff_formula <- step(cu_r_whiff, direction = "backward")
cu_r_whiff_formula$formula
# Removed: pitch_speed, pfx_x
cu_r_whiff_test <- augment(cu_r_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "right",
pitch = "curveball")
rmse(cu_r_whiff_test$prediction, cu_r_whiff_test$whiff)
# Barrel ####
# Refined Model
cu_r_barrel <- glm(Barrel ~ pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bbarrel,
data = cu_r, family = binomial)
# Removed: pitch_speed, pfx_x
cu_r_barrel_test <- augment(cu_r_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "right",
pitch = "curveball")
rmse(cu_r_barrel_test$prediction, cu_r_barrel_test$Barrel)
# Strike ####
# Refined Model
cu_r_strike <- glm(STRIKE ~ pfx_z + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = cu_r, family = binomial)
cu_r_strike_formula <- step(cu_r_strike, direction = "backward")
cu_r_strike_formula$formula
# Removed: pitch_speed, pfx_x, pfx_total
cu_r_strike_test <- augment(cu_r_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "right",
pitch = "curveball")
rmse(cu_r_strike_test$prediction, cu_r_strike_test$STRIKE)
cu_l <- rhp %>%
filter(pitch_type == "CU",
hitter == "L") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
cu_l_whiff <- glm(whiff ~ pitch_speed + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = cu_l, family = binomial)
cu_l_whiff_formula <- step(cu_l_whiff, direction = "backward")
cu_l_whiff_formula$formula
# Removed: pfx_x, pfx_z, pfx_total
cu_l_whiff_test <- augment(cu_l_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "left",
pitch = "curveball")
rmse(cu_l_whiff_test$prediction, cu_l_whiff_test$whiff)
# Barrel ####
# Refined Model
cu_l_barrel <- glm(Barrel ~ pfx_total + dist_x + dist_z +
I(dist_x^2) + I(dist_z^2) + pred_bbarrel,
data = cu_l, family = binomial)
cu_l_barrel_formula <- step(cu_l_barrel, direction = "backward")
cu_l_barrel_formula$formula
# Removed: pfx_x, zone, pfx_z, release_spin_rate, dist_prop, pitch_speed
cu_l_barrel_test <- augment(cu_l_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "left",
pitch = "curveball")
rmse(cu_l_barrel_test$prediction, cu_l_barrel_test$Barrel)
# Strike ####
# Refined Model
cu_l_strike <- glm(STRIKE ~ pfx_total + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = cu_l, family = binomial)
cu_l_strike_formula <- step(cu_l_strike, direction = "backward")
cu_l_strike_formula$formula
# Removed: pitch_speed, pfx_x, pfx_z
cu_l_strike_test <- augment(cu_l_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "left",
pitch = "curveball")
rmse(cu_l_strike_test$prediction, cu_l_strike_test$STRIKE)
ch_r <- rhp %>%
filter(pitch_type == "CH",
hitter == "R") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
ch_r_whiff <- glm(whiff ~ pitch_speed + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + pred_bwhiff,
data = ch_r, family = binomial)
# Removed: release_spin_rate, pfx_x, pfx_z
# Model Evaluation
summary(ch_r_whiff)
ch_r_whiff_test <- augment(ch_r_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "right",
pitch = "changeup")
rmse(ch_r_whiff_test$prediction, ch_r_whiff_test$whiff)
# Barrel ####
# Refined Model
ch_r_barrel <- glm(Barrel ~ pfx_z + pfx_total + dist_x + dist_z +
I(dist_x^2) + I(dist_z^2) + pred_bbarrel,
data = ch_r, family = binomial)
# Removed: release_spin_rate, pitch_speed, zone, dist_prop, pfx_x
# Model Evaluation
summary(ch_r_barrel)
ch_r_barrel_test <- augment(ch_r_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "right",
pitch = "changeup")
rmse(ch_r_barrel_test$prediction, ch_r_barrel_test$Barrel)
# Strike ####
# Refined Model
ch_r_strike <- glm(STRIKE ~ pitch_speed + pfx_z + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + pred_bstrike,
data = ch_r, family = binomial)
# Removed: release_spin_rate, pfx_x
# Model Evaluation
# summary(ch_r_strike)
ch_r_strike_test <- augment(ch_r_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "right",
pitch = "changeup")
rmse(ch_r_strike_test$prediction, ch_r_strike_test$STRIKE)
ch_l <- rhp %>%
filter(pitch_type == "CH",
hitter == "L") %>%
mutate(Barrel = ifelse(Barrel == TRUE, 1, 0),
whiff = ifelse(whiff == TRUE, 1, 0))
# Whiff ####
# Refined Model
ch_l_whiff <- glm(whiff ~ pitch_speed + pfx_z + zone + dist_x + dist_z + dist_prop +
I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bwhiff,
data = ch_l, family = binomial)
ch_l_whiff_formula <- step(ch_l_whiff, direction = "backward")
ch_l_whiff_formula$formula
# Removed: pfx_total, pfx_x
# Model Evaluation
summary(ch_l_whiff)
ch_l_whiff_test <- augment(ch_l_whiff, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "whiff",
Hand = "left",
pitch = "changeup")
rmse(ch_l_whiff_test$prediction, ch_l_whiff_test$whiff)
# Barrel ####
# Refined Model
ch_l_barrel <- glm(Barrel ~ dist_x + dist_z + I(dist_x^2) + I(dist_z^2) + pred_bbarrel,
data = ch_l, family = binomial)
# Removed: pfx_x, release_spin_rate, pitch_speed, pfx_total, dist_prop, pfx_z, zone
# Model Evaluation
summary(ch_l_barrel)
ch_l_barrel_test <- augment(ch_l_barrel, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "barrel",
Hand = "left",
pitch = "changeup")
rmse(ch_l_barrel_test$prediction, ch_l_barrel_test$Barrel)
# Strike ####
# Refined Model
ch_l_strike <- glm(STRIKE ~ pitch_speed + pfx_total + zone + dist_x + dist_z +
dist_prop + I(dist_x^2) + I(dist_z^2) + release_spin_rate + pred_bstrike,
data = ch_l, family = binomial)
ch_l_strike_formula <- step(ch_l_strike, direction = "backward")
ch_l_strike_formula$formula
# Removed: pfx_x, pfx_z
# Model Evaluation
# summary(ch_r_strike)
ch_l_strike_test <- augment(ch_l_strike, type.predict = "response") %>%
rename(prediction = `.fitted`) %>%
mutate(Response = "strike",
Hand = "left",
pitch = "changeup")
rmse(ch_l_strike_test$prediction, ch_l_strike_test$STRIKE)
View(ch_r_strike_test)
models <- rbind(
tidy(fb_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "fastball"),
tidy(fb_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "fastball"),
tidy(fb_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "fastball"),
tidy(fb_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "fastball"),
tidy(sl_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "slider"),
tidy(sl_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "slider"),
tidy(sl_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "slider"),
tidy(sl_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "slider"),
tidy(sl_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "slider"),
tidy(sl_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "slider"),
tidy(cu_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "curveball"),
tidy(cu_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "curveball"),
tidy(cu_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "curveball"),
tidy(cu_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "curveball"),
tidy(cu_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "curveball"),
tidy(cu_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "curveball"),
tidy(ch_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "changeup"),
tidy(ch_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "changeup"),
tidy(ch_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "changeup"),
tidy(ch_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "changeup"),
tidy(ch_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "changeup"),
tidy(ch_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "changeup"),
)
models <- rbind(
tidy(fb_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "fastball"),
tidy(fb_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "fastball"),
tidy(fb_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "fastball"),
tidy(fb_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "fastball"),
tidy(fb_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "fastball"),
tidy(sl_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "slider"),
tidy(sl_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "slider"),
tidy(sl_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "slider"),
tidy(sl_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "slider"),
tidy(sl_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "slider"),
tidy(sl_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "slider"),
tidy(cu_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "curveball"),
tidy(cu_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "curveball"),
tidy(cu_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "curveball"),
tidy(cu_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "curveball"),
tidy(cu_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "curveball"),
tidy(cu_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "curveball"),
tidy(ch_r_whiff) %>% mutate(Response = "whiff",
Hand = "right", Pitch = "changeup"),
tidy(ch_r_barrel) %>% mutate(Response = "barrel",
Hand = "right", Pitch = "changeup"),
tidy(ch_r_strike) %>% mutate(Response = "strike",
Hand = "right", Pitch = "changeup"),
tidy(ch_l_whiff) %>% mutate(Response = "whiff",
Hand = "left", Pitch = "changeup"),
tidy(ch_l_barrel) %>% mutate(Response = "barrel",
Hand = "left", Pitch = "changeup"),
tidy(ch_l_strike) %>% mutate(Response = "strike",
Hand = "left", Pitch = "changeup")
)
write.csv(models, "models3.csv")
shiny::runApp()
