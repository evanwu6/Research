pfx_total + speed_change + break_change + prev_pitch +
speed_fb_diff + release_spin_rate +
I(plate_z^2) + pred_bwhiff,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_whiff)
sl_whiff <- augment(sl_model_whiff)
View(sl_whiff)
sl_whiff <- augment(sl_model_whiff) %>%
mutate(Response = "whiff",
pitch = "slider")
# Model Predictions
sl_whiff2 <- sl_whiff %>%
mutate(prediction_log = predict(sl_model_whiff, sliders),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction))
# Model Predictions
sl_whiff2 <- sl_whiff %>%
mutate(prediction_log = predict(sl_model_whiff, sl_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction))
View(sl_model_strike_all)
View(sl_whiff2)
rm(sl_whiff)
sl_whiff <- augment(sl_model_whiff) %>%
mutate(prediction_log = predict(sl_model_whiff, sl_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider")
sl_whiff <- augment(sl_model_whiff)
sl_whiff <- sl_whiff %>%
mutate(prediction_log = predict(sl_model_whiff, sl_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider")
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_x + plate_z + zone +
pfx_total + speed_change + break_change + distance + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_z + zone +
pfx_total + speed_change + break_change + distance + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_z + zone +
pfx_total + speed_change + break_change + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
# Model Evaluation
summary(fb_model_whiff)
fb_whiff <- augment(fb_model_whiff)
fb_whiff <- fb_whiff %>%
mutate(prediction_log = predict(fb_model_whiff, fb_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball")
fb_whiff <- augment(fb_model_whiff)
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_z + zone +
pfx_total + speed_change + break_change + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
fb_whiff <- augment(fb_model_whiff)
fb_whiff <- fb_whiff %>%
mutate(prediction_log = predict(fb_model_whiff, fb_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball")
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_z + zone +
pfx_total + speed_change + break_change + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
fb_whiff <- augment(fb_model_whiff)
fb_whiff <- fb_whiff %>%
mutate(prediction_log = predict(fb_model_whiff, fb_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball")
# Refined Model
fb_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_x + plate_z + zone +
pfx_total + speed_change + break_change + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bwhiff,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_whiff)
fb_whiff <- augment(fb_model_whiff)
fb_whiff <- fb_whiff %>%
mutate(prediction_log = predict(fb_model_whiff, fb_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball")
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone + distance
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone + distance +
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_barrel)
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone +
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_barrel)
sl_whiff <- augment(sl_model_barrel)
# Model Evaluation
summary(sl_model_whiff)
# Refined Model
sl_model_whiff <- glm(whiff ~ pitch_speed + pfx_x + pfx_z + plate_x + plate_z + zone +
pfx_total + speed_change + break_change + prev_pitch +
speed_fb_diff + release_spin_rate +
I(plate_z^2) + pred_bwhiff,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_whiff)
sl_whiff <- augment(sl_model_whiff)
sl_whiff <- sl_whiff %>%
mutate(prediction_log = predict(sl_model_whiff, sl_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider")
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone +
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_barrel)
sl_barrel <- augment(sl_model_barrel)
sl_barrel <- augment(sl_model_barrel)
sl_barrel <- sl_barrel %>%
mutate(prediction_log = predict(sl_model_barrel, sl_barrel),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "barrel",
pitch = "slider")
View(sl_whiff)
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone + plate_x +
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = sliders, family = binomial)
# Refined Model
sl_model_barrel <- glm(Barrel ~ pitch_speed + plate_z + zone + plate_x +
prev_pitch + speed_fb_diff + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_barrel)
# Model Evaluation
summary(sl_model_barrel)
sl_barrel <- augment(sl_model_barrel)
sl_barrel <- sl_barrel %>%
mutate(prediction_log = predict(sl_model_barrel, sl_barrel),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "barrel",
pitch = "slider")
# Refined Model
fb_model_barrel <- glm(Barrel ~ pitch_speed + pfx_z + plate_z + zone +
break_change + prev_pitch + distance +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_barrel)
# Refined Model
fb_model_barrel <- glm(Barrel ~ pitch_speed + pfx_z + plate_z + zone +
break_change + prev_pitch +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_barrel)
# Model Evaluation
summary(fb_model_barrel)
fb_barrel <- augment(fb_model_barrel)
fb_barrel <- fb_barrel %>%
mutate(prediction_log = predict(fb_model_barrel, fb_barrel),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "barrel",
pitch = "fastball")
# Refined Model
fb_model_barrel <- glm(Barrel ~ pitch_speed + pfx_z + plate_z + zone +
break_change + prev_pitch + plate_x +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = fastballs, family = binomial)
# Refined Model
fb_model_barrel <- glm(Barrel ~ pitch_speed + pfx_z + plate_z + zone +
break_change + prev_pitch + plate_x +
release_spin_rate + I(plate_x^2) + I(plate_z^2) + pred_bbarrel,
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_barrel)
fb_barrel <- augment(fb_model_barrel)
fb_barrel <- augment(fb_model_barrel)
fb_barrel <- fb_barrel %>%
mutate(prediction_log = predict(fb_model_barrel, fb_barrel),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "barrel",
pitch = "fastball")
sliders <- sliders %>%
mutate(fb_prev = ifelse(prev_pitch == "Fastball", 1, 0)) %>%
mutate(count_s = case_when(count  %in% c("0_0", "1_1", "2_2") ~ "Even",
count  %in%  c("1_0", "2_1", "2_0", "3_0", "3_1") ~ "Hitter",
count %in%  c("0_1", "0_2", "1_2") ~ "Pitcher",
count == "3_2" ~ "Full"))
sl_model_strike <- glm(STRIKE ~ pfx_x + pfx_z + plate_x + plate_z + zone +
count_s + pfx_total + break_change + distance + prev_pitch +
speed_fb_diff + release_spin_rate +
I(plate_x^2) + I(plate_z^2),
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_strike)
sliders <- sliders %>%
mutate(fb_prev = ifelse(prev_pitch == "Fastball", 1, 0)) %>%
mutate(count_s = case_when(count  %in% c("0_0", "1_1", "2_2") ~ "Even",
count  %in%  c("1_0", "2_1", "2_0", "3_0", "3_1") ~ "Hitter",
count %in%  c("0_1", "0_2", "1_2") ~ "Pitcher",
count == "3_2" ~ "Full"))
sl_model_strike <- glm(STRIKE ~ pfx_x + pfx_z + plate_x + plate_z + zone +
count_s + pfx_total + break_change + distance + prev_pitch +
speed_fb_diff + release_spin_rate +
I(plate_x^2) + I(plate_z^2),
data = sliders, family = binomial)
# Model Evaluation
summary(sl_model_strike)
sl_strike <- augment(sl_model_strike)
sl_strike <- sl_strike %>%
mutate(prediction_log = predict(sl_model_strike, sl_strike),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "strike",
pitch = "slider")
fb_model_strike <- glm(STRIKE ~ pitch_speed + pfx_x + pfx_z + plate_x + plate_z + zone +
count + pfx_total + break_change + distance +
release_spin_rate + I(plate_x^2) + I(plate_z^2),
data = fastballs, family = binomial)
# Model Evaluation
summary(fb_model_strike)
fb_strike <- augment(fb_model_strike)
fb_strike <- fb_strike %>%
mutate(prediction_log = predict(fb_model_strike, fb_strike),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "strike",
pitch = "fastball")
all_models <- rbind(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike)
all_models <- bind_rows(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike)
View(all_models)
all_models <- bind_rows(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike) %>%
select(Response:pitch, whiff:pred_bwhiff, `I(plate_x^2)`:count, `.fitted`:rounded_pred)
sl_whiff_naive <- glm(whiff ~ 1,
data = fastballs, family = binomial)
sl_whiff_naive <- glm(whiff ~ 1,
data = fastballs, family = binomial) %>%
augment()
sl_model_whiff_naive <- glm(whiff ~ 1,
data = fastballs, family = binomial)
sl_model_whiff_int <- glm(whiff ~ 1,
data = fastballs, family = binomial)
sl_whiff_inr <- augment(sl_model_whiff_int)
sl_whiff_int <- augment(sl_model_whiff_int)
sl_whiff_int <- sl_whiff_int %>%
mutate(prediction_log = predict(sl_model_whiff_int, sl_whiff),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider",
type = "intercept only")
sl_model_whiff_int <- glm(whiff ~ 1,
data = fastballs, family = binomial)
sl_whiff_int <- augment(sl_model_whiff_int)
sl_whiff_int <- sl_whiff_int %>%
mutate(prediction_log = predict(sl_model_whiff_int, sl_whiff_int),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider",
type = "intercept only")
sl_model_whiff_int <- glm(whiff ~ 1,
data = sliders, family = binomial)
sl_whiff_int <- augment(sl_model_whiff_int)
sl_whiff_int <- sl_whiff_int %>%
mutate(prediction_log = predict(sl_model_whiff_int, sl_whiff_int),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider",
type = "intercept only")
sl_whiff_int <- augment(sl_model_whiff_int)
sl_whiff_int <- sl_whiff_int %>%
mutate(prediction_log = predict(sl_model_whiff_int, sl_whiff_int),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider",
type = "intercept only")
fb_model_whiff_int <- glm(whiff ~ 1,
data = fastballs, family = binomial)
fb_whiff_int <- augment(fb_model_whiff_int)
fb_whiff_int <- fb_whiff_int %>%
mutate(prediction_log = predict(fb_model_whiff_int, fb_whiff_int),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball",
type = "intercept only")
View(sliders)
sl_model_zone_int <- glm(whiff ~ zone,
data = sliders, family = binomial)
sl_model_zone_int %>% summary
sl_model_whiff_zone <- glm(whiff ~ zone,
data = sliders, family = binomial)
sl_model_whiff_zone <- glm(whiff ~ zone,
data = sliders, family = binomial)
sl_whiff_zone <- augment(sl_model_whiff_zone)
sl_model_whiff_zone <- glm(whiff ~ zone,
data = sliders, family = binomial)
sl_whiff_zone <- augment(sl_model_whiff_zone)
sl_whiff_zone <- sl_whiff_zone %>%
mutate(prediction_log = predict(sl_model_whiff_zone, sl_whiff_zone),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "slider",
type = "zone only")
fb_model_whiff_zone <- glm(whiff ~ zone,
data = fastballs, family = binomial)
fb_whiff_zone <- augment(fb_model_whiff_zone)
fb_model_whiff_zone <- glm(whiff ~ zone,
data = fastballs, family = binomial)
fb_whiff_zone <- augment(fb_model_whiff_zone)
fb_whiff_zone <- fb_whiff_zone %>%
mutate(prediction_log = predict(fb_model_whiff_zone, fb_whiff_zone),
prediction = 1 / (1 + exp(-prediction_log)),
rounded_pred = case_when(
prediction >= 0.5 ~ 1,
prediction < 0.5 ~ 0
)) %>%
filter(!is.na(prediction)) %>%
mutate(Response = "whiff",
pitch = "fastball",
type = "zone only")
tidy(fb_model_whiff_zone)
all_models <- bind_rows(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike,
sl_whiff_int, fb_whiff_int,
sl_whiff_zone, fb_whiff_zone)
View(all_models)
all_models <- bind_rows(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike,
sl_whiff_int, fb_whiff_int,
sl_whiff_zone, fb_whiff_zone) %>%
select(Response:pitch, type, whiff:pred_bwhiff, `I(plate_x^2)`:count, `.fitted`:rounded_pred)
all_models_data <- bind_rows(sl_whiff, fb_whiff,
sl_barrel, fb_barrel,
sl_strike, fb_strike,
sl_whiff_int, fb_whiff_int,
sl_whiff_zone, fb_whiff_zone) %>%
select(Response:pitch, type, whiff:pred_bwhiff, `I(plate_x^2)`:count, `.fitted`:rounded_pred)
all_models <- bind_rows(
tidy(sl_model_whiff), tidy(fb_model_whiff),
tidy(sl_model_barrel), tidy(fb_model_barrel),
tidy(sl_model_strike), tidy(fb_model_strike),
tidy(sl_model_whiff_int), tidy(fb_model_whiff_int),
tidy(sl_model_whiff_zone), tidy(fb_model_whiff_zone)
)
View(all_models)
all_models <- bind_rows(
tidy(sl_model_whiff) %>% mutate(Response = "whiff", pitch = "slider", type = "complex"),
tidy(fb_model_whiff) %>% mutate(Response = "whiff", pitch = "fastball", type = "complex"),
tidy(sl_model_barrel) %>% mutate(Response = "barrel", pitch = "slider", type = "complex"),
tidy(fb_model_barrel) %>% mutate(Response = "barrel", pitch = "fastball", type = "complex"),
tidy(sl_model_strike) %>% mutate(Response = "strike", pitch = "slider", type = "complex"),
tidy(fb_model_strike) %>% mutate(Response = "strike", pitch = "fastball", type = "complex"),
tidy(sl_model_whiff_int) %>% mutate(Response = "whiff", pitch = "slider",
type = "intercept only"),
tidy(fb_model_whiff_int) %>% mutate(Response = "whiff", pitch = "fastball",
type = "intercept only"),
tidy(sl_model_whiff_zone) %>% mutate(Response = "whiff", pitch = "slider",
type = "zone only"),
tidy(fb_model_whiff_zonw) %>% mutate(Response = "whiff", pitch = "fastball",
type = "zone only")
)
all_models <- bind_rows(
tidy(sl_model_whiff) %>% mutate(Response = "whiff", pitch = "slider", type = "complex"),
tidy(fb_model_whiff) %>% mutate(Response = "whiff", pitch = "fastball", type = "complex"),
tidy(sl_model_barrel) %>% mutate(Response = "barrel", pitch = "slider", type = "complex"),
tidy(fb_model_barrel) %>% mutate(Response = "barrel", pitch = "fastball", type = "complex"),
tidy(sl_model_strike) %>% mutate(Response = "strike", pitch = "slider", type = "complex"),
tidy(fb_model_strike) %>% mutate(Response = "strike", pitch = "fastball", type = "complex"),
tidy(sl_model_whiff_int) %>% mutate(Response = "whiff", pitch = "slider",
type = "intercept only"),
tidy(fb_model_whiff_int) %>% mutate(Response = "whiff", pitch = "fastball",
type = "intercept only"),
tidy(sl_model_whiff_zone) %>% mutate(Response = "whiff", pitch = "slider",
type = "zone only"),
tidy(fb_model_whiff_zone) %>% mutate(Response = "whiff", pitch = "fastball",
type = "zone only")
)
