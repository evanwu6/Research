x < 0, z <= 0 ~ "14")
zone
}
t <- zone_data %>% mutate(z = get_zone(x, z))
get_zone(5, 1)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0, z <= 0 ~ "14")
}
get_zone(5, 1)
get_zone(0, 1)
get_zone(0, 0.5)
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
TRUE ~ "T")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x >= 0 & z >= 0 ~ "11",
x <= 0 & z >= 0 ~ "12",
x > 0 & z < 0 ~ "13",
x < 0, z < 0 ~ "14")
}
get_zone(0.5, 0.5)
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0, z <= 0 ~ "14",
TRUE ~ "15")
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0, z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
# x >= 0 & z < 0 ~ "13",
# x < 0, z <= 0 ~ "14",
TRUE ~ "15")
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
# x >= 0 & z < 0 ~ "13",
# x < 0, z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
# x < 0, z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0, z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x <= 0, z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0, z < 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= 1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= 1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= 1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0 & z <= 0 ~ "14",
TRUE ~ "15")
}
get_zone(0.5, 0.5)
t <- zone_data %>% mutate(t = get_zone(x, z))
View(t)
t %>% ggplot(aes(x = x, y = z)) + geom_point(aes(color = t), size = 0.1)
t %>% ggplot(aes(x = x, y = z)) + geom_point(aes(color = t), size = 0.5)
t %>% group_by(t) %>% summarize(n)
t %>% group_by(t) %>% summarize(n()) %>% View
t %>% filter(x > 0.33, x <= 1, z > 0.33, z<= 1) %>% View
t %>% filter(x < -0.33, x >= -1, z > 0.33, z<= 1) %>% View
# Zone Function (by Proportion)
get_zone <- function(x, z){
case_when(x > 0.33 & x <= 1 & z <= 1 & z > 0.33 ~ "1",
x <= 0.33 & x >= -0.33 & z <= 1 & z > 0.33 ~ "2",
x < -0.33 & x >= -1 & z <= 1 & z > 0.33 ~ "3",
x > 0.33 & x <= 1 & z <= 0.33 & z >= -0.33 ~ "4",
x <= 0.33 & x >= -0.33 & z <= 0.33 & z >= -0.33 ~ "5",
x < -0.33 & x >= -1 & z <= 0.33 & z >= -0.33 ~ "6",
x > 0.33 & x <= 1 & z < -0.33 & z >= -1 ~ "7",
x <= 0.33 & x >= -0.33 & z < -0.33 & z >= -1 ~ "8",
x < -0.33 & x >= -1 & z < -0.33 & z >= -1 ~ "9",
x > 0 & z >= 0 ~ "11",
x <= 0 & z > 0 ~ "12",
x >= 0 & z < 0 ~ "13",
x < 0 & z <= 0 ~ "14",
TRUE ~ "15")
}
t <- zone_data %>% mutate(t = get_zone(x, z))
t %>% group_by(t) %>% summarize(n()) %>% View
t %>% ggplot(aes(x = x, y = z)) + geom_point(aes(color = t), size = 0.5)
t %>% ggplot(aes(x = x, y = z)) + geom_point(aes(color = t), size = 1) + theme_void() + coord_fixed()
runApp()
e <- get_zone(0, 2)
str(e)
runApp()
runApp()
b_hand == "L"
b_hand = "L"
pitch_type = "slide"
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z)) %>% View
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z)) %>%
mutate(z_pred = case_when(z == "1" ~  1,
z == "2" ~  test$zone2,
z == "3" ~  test$zone3,
z == "4" ~  test$zone4,
z == "6" ~  test$zone6,
z == "7" ~  test$zone7,
z == "8" ~  test$zone8,
z == "9" ~  test$zone9,
z == "11" ~  test$zone11,
z == "12" ~  test$zone12,
z == "13" ~  test$zone13,
z == "14" ~  test$zone14,
TRUE ~ 0)) %>%
select(-response:-pitch) %>%
mutate(pred = pred + gen_pred + z_pred) %>%
mutate(pred = 1 / (1 + exp(-pred)))
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z))
View(t)
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand,
Pitch == pitch)
pitch = pitch_type
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand,
Pitch == pitch)
test <- whiff %>%
select(term:estimate) %>%
pivot_wider(names_from = "term",
values_from = "estimate")
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand,
Pitch == pitch)
View(whiff)
View(model)
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L"))
View(whiff)
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand,
Pitch == pitch)
View(whiff)
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff")
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand)
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Pitch == pitch)
pitch = "slider"
pitch_type = "slider"
whiff <- model %>%
mutate(Hand = ifelse(Hand == "right", "R", "L")) %>%
filter(Response == "whiff",
Hand == b_hand,
Pitch == pitch)
test <- whiff %>%
select(term:estimate) %>%
pivot_wider(names_from = "term",
values_from = "estimate")
possible_cols <- c("(Intercept)", "pitch_speed", "pfx_x", "pfx_z", "pfx_total",
"zone1", "zone2", "zone3", "zone4", "zone6", "zone7",
"zone8", "zone9", "zone11", "zone12", "zone13", "zone14",
"dist_x", "dist_z", "dist_prop", "I(dist_x^2)", "I(dist_z^2)",
"release_spin_rate", "pred_bwhiff")
for (col_name in possible_cols) {
if (col_name %in% colnames(test)) {
} else {
test[[col_name]] <- 0
}
}
View(test)
zone_value <- case_when(zone == 1 ~  test$zone1,
zone == 2 ~  test$zone2,
zone == 3 ~  test$zone3,
zone == 4 ~  test$zone4,
zone == 6 ~  test$zone6,
zone == 7 ~  test$zone7,
zone == 8 ~  test$zone8,
zone == 9 ~  test$zone9,
zone == 11 ~  test$zone11,
zone == 12 ~  test$zone12,
zone == 13 ~  test$zone13,
zone == 14 ~  test$zone14,
TRUE ~ 0)
pred_bwhiff <- pred_means %>%
filter(hitter == b_hand,
pitch_type == input$pitch) %>%
select(whiff_mean)
prediction <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$dist_x*dist_x + test$dist_z*dist_z + test$dist_prop*dist_prop +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + zone_value + test$pred_bwhiff*pred_bwhiff$whiff_mean
prediction <- 1 / (1 + exp(-prediction))
prediction <- scales::percent(prediction, accuracy = 0.1)
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
pitch_type <- pitch
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z)) %>%
mutate(z_pred = case_when(z == "1" ~  1,
z == "2" ~  test$zone2,
z == "3" ~  test$zone3,
z == "4" ~  test$zone4,
z == "6" ~  test$zone6,
z == "7" ~  test$zone7,
z == "8" ~  test$zone8,
z == "9" ~  test$zone9,
z == "11" ~  test$zone11,
z == "12" ~  test$zone12,
z == "13" ~  test$zone13,
z == "14" ~  test$zone14,
TRUE ~ 0)) %>%
select(-response:-pitch) %>%
mutate(pred = pred + gen_pred + z_pred) %>%
mutate(pred = 1 / (1 + exp(-pred)))
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
pitch_speed = 92
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
pfx_x = -15
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
pfx_z = 2
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
pfx_total = sqrt(229)
gen_pred <- test$`(Intercept)` + test$pitch_speed*pitch_speed +
test$pfx_x*pfx_x + test$pfx_z*pfx_z + test$pfx_total*pfx_total +
test$`I(dist_x^2)`*dist_x2 + test$`I(dist_z^2)`*dist_z2 +
test$release_spin_rate*release_spin_rate + test$pred_bwhiff*pred_bwhiff$whiff_mean
gen_pred = 2
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z)) %>%
mutate(z_pred = case_when(z == "1" ~  1,
z == "2" ~  test$zone2,
z == "3" ~  test$zone3,
z == "4" ~  test$zone4,
z == "6" ~  test$zone6,
z == "7" ~  test$zone7,
z == "8" ~  test$zone8,
z == "9" ~  test$zone9,
z == "11" ~  test$zone11,
z == "12" ~  test$zone12,
z == "13" ~  test$zone13,
z == "14" ~  test$zone14,
TRUE ~ 0)) %>%
select(-response:-pitch) %>%
mutate(pred = pred + gen_pred + z_pred) %>%
mutate(pred = 1 / (1 + exp(-pred)))
View(heat_map)
View(model)
View(whiff)
heat_map$z_pred %>% unique
runApp()
runApp()
runApp()
sum(2, 1,2 4, 2)
sum(c(2, 1,2 4, 2))
sum(c(2, 1,2, 4, 2))
sum(2, 1,2, 4, 2)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
View(test)
heat_map <- zone_data %>%
mutate(hand = ifelse(hand == "right", "R", "L")) %>%
filter(response == "whiff",
hand == b_hand,
pitch == pitch_type) %>%
mutate(z = get_zone(x, z)) %>%
mutate(z_pred = case_when(z == "1" ~  test$zone1,
z == "2" ~  test$zone2,
z == "3" ~  test$zone3,
z == "4" ~  test$zone4,
z == "6" ~  test$zone6,
z == "7" ~  test$zone7,
z == "8" ~  test$zone8,
z == "9" ~  test$zone9,
z == "11" ~  test$zone11,
z == "12" ~  test$zone12,
z == "13" ~  test$zone13,
z == "14" ~  test$zone14,
TRUE ~ 0)) %>%
select(-response:-pitch) %>%
mutate(pred = pred + gen_pred + z_pred) %>%
mutate(pred = 1 / (1 + exp(-pred)))
View(heat_map)
runApp()
runApp()
runApp()
runApp()
runApp()
